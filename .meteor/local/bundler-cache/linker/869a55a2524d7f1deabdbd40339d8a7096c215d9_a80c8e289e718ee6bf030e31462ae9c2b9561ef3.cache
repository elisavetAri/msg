[{"type":"js","data":"//////////////////////////////////////////////////////////////////////////\n//                                                                      //\n// This is a generated file. You can view the original                  //\n// source in your browser if your browser supports source maps.         //\n// Source maps are supported by all recent versions of Chrome, Safari,  //\n// and Firefox, and by Internet Explorer 11.                            //\n//                                                                      //\n//////////////////////////////////////////////////////////////////////////\n\n\n(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar Accounts = Package['accounts-base'].Accounts;\nvar Session = Package.session.Session;\nvar ReactiveVar = Package['reactive-var'].ReactiveVar;\nvar Tracker = Package.tracker.Tracker;\nvar Deps = Package.tracker.Deps;\nvar meteorInstall = Package.modules.meteorInstall;\nvar meteorBabelHelpers = Package['babel-runtime'].meteorBabelHelpers;\nvar Promise = Package.promise.Promise;\n\nvar require = meteorInstall({\"node_modules\":{\"meteor\":{\"ostrio:user-status\":{\"client\":{\"main.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                 //\n// packages/ostrio_user-status/client/main.js                                                      //\n//                                                                                                 //\n/////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                   //\nmodule.export({\n  UserStatus: () => UserStatus\n});\nlet throttle;\nmodule.link(\"./throttle\", {\n  default(v) {\n    throttle = v;\n  }\n\n}, 0);\nlet Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 1);\nlet Session;\nmodule.link(\"meteor/session\", {\n  Session(v) {\n    Session = v;\n  }\n\n}, 2);\nlet Tracker;\nmodule.link(\"meteor/tracker\", {\n  Tracker(v) {\n    Tracker = v;\n  }\n\n}, 3);\nlet Accounts;\nmodule.link(\"meteor/accounts-base\", {\n  Accounts(v) {\n    Accounts = v;\n  }\n\n}, 4);\nlet ReactiveVar;\nmodule.link(\"meteor/reactive-var\", {\n  ReactiveVar(v) {\n    ReactiveVar = v;\n  }\n\n}, 5);\n\nconst NoOp = function () {};\n\nclass UserStatusClass {\n  constructor() {\n    Session.setDefault('UserStatusIdle', false);\n    this.status = new ReactiveVar('offline');\n    this.hidden = {};\n    /* @description Set right visibilitychange event and property names */\n\n    this.hidden.str = false;\n    this.hidden.evt = void 0;\n\n    if (typeof document.hidden !== 'undefined') {\n      this.hidden.str = 'hidden';\n      this.hidden.evt = 'visibilitychange';\n    } else if (typeof document.mozHidden !== 'undefined') {\n      this.hidden.str = 'mozHidden';\n      this.hidden.evt = 'mozvisibilitychange';\n    } else if (typeof document.msHidden !== 'undefined') {\n      this.hidden.str = 'msHidden';\n      this.hidden.evt = 'msvisibilitychange';\n    } else if (typeof document.webkitHidden !== 'undefined') {\n      this.hidden.str = 'webkitHidden';\n      this.hidden.evt = 'webkitvisibilitychange';\n    }\n\n    this.hidden.check = () => {\n      return document[this.hidden.str];\n    };\n    /* @description Set active/inactive user status */\n\n\n    this.hidden.set = () => {\n      if (this.hidden.check()) {\n        this.goIdle();\n      } else {\n        this.goOnline();\n      }\n    };\n\n    Tracker.autorun(() => {\n      const _user = Meteor.user();\n\n      if (_user) {\n        Session.set('UserStatusIdle', _user.profile.idle || false);\n\n        if (_user.profile.idle) {\n          this.status.set('idle');\n        } else if (_user.profile.online) {\n          this.status.set('online');\n        } else {\n          this.status.set('offline');\n        }\n      } else {\n        Session.set('UserStatusIdle', false);\n        this.status.set('offline');\n      }\n    });\n    /* @description Set event listeners */\n\n    this.on(document, [this.hidden.evt], this.hidden.set);\n    this.on(window, ['mousemove', 'mousedown', 'keypress', 'DOMMouseScroll', 'mousewheel', 'touchmove', 'MSPointerMove', 'MSPointerMove'], throttle(this.goOnline.bind(this), 777));\n    this.on(document, ['mousemove', 'mousedown', 'keypress', 'DOMMouseScroll', 'mousewheel', 'touchmove', 'MSPointerMove', 'MSPointerMove'], throttle(this.goOnline.bind(this), 777));\n  }\n\n  on(obj, events, fn) {\n    events.forEach(event => {\n      if (obj.addEventListener) {\n        obj.addEventListener(event, fn, {\n          passive: true,\n          capture: false\n        });\n      } else {\n        obj.attachEvent('on' + event, fn);\n      }\n    });\n  }\n\n  goOnline() {\n    const _user = Meteor.user();\n\n    if (_user && _user._id && (_user.profile.online !== true || _user.profile.idle !== false)) {\n      Meteor.users.update({\n        _id: _user._id\n      }, {\n        $set: {\n          'profile.online': true,\n          'profile.idle': false\n        }\n      }, NoOp);\n    }\n  }\n\n  goIdle() {\n    const _user = Meteor.user();\n\n    if (_user && _user._id && (_user.profile.online !== true || _user.profile.idle !== true)) {\n      Meteor.users.update({\n        _id: _user._id\n      }, {\n        $set: {\n          'profile.online': true,\n          'profile.idle': true\n        }\n      }, NoOp);\n    }\n  }\n\n  goOffline() {\n    let _user = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Meteor.user();\n\n    if (_user && _user._id && (_user.profile.online !== false || _user.profile.idle !== false)) {\n      Meteor.users.update({\n        _id: _user._id\n      }, {\n        $set: {\n          'profile.online': false,\n          'profile.idle': false\n        }\n      }, NoOp);\n    }\n  }\n\n  startTimer() {\n    Meteor.setInterval(this.goIdle.bind(this), 30000);\n  }\n\n  start() {\n    this.startTimer();\n  }\n\n}\n\nconst UserStatus = new UserStatusClass();\nAccounts.onLogin(UserStatus.start.bind(UserStatus));\nAccounts.onLogout(UserStatus.goOffline.bind(UserStatus));\n/////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"throttle.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                 //\n// packages/ostrio_user-status/client/throttle.js                                                  //\n//                                                                                                 //\n/////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                   //\nmodule.exportDefault(function (func, wait) {\n  let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  let context;\n  let args;\n  let result;\n  let timeout = null;\n  let previous = 0;\n\n  const later = () => {\n    previous = options.leading === false ? 0 : Date.now();\n    timeout = null;\n    result = func.apply(context, args);\n\n    if (!timeout) {\n      context = args = null;\n    }\n  };\n\n  return function () {\n    const now = Date.now();\n\n    if (!previous && options.leading === false) {\n      previous = now;\n    }\n\n    const remaining = wait - (now - previous);\n    context = this;\n    args = arguments;\n\n    if (remaining <= 0 || remaining > wait) {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n\n      previous = now;\n      result = func.apply(context, args);\n\n      if (!timeout) {\n        context = args = null;\n      }\n    } else if (!timeout && options.trailing !== false) {\n      timeout = setTimeout(later, remaining);\n    }\n\n    return result;\n  };\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}}}}},{\n  \"extensions\": [\n    \".js\",\n    \".json\"\n  ]\n});\n\nvar exports = require(\"/node_modules/meteor/ostrio:user-status/client/main.js\");\n\n/* Exports */\nPackage._define(\"ostrio:user-status\", exports);\n\n})();\n","servePath":"/packages/ostrio_user-status.js","sourceMap":{"version":3,"sources":["packages/ostrio:user-status/client/main.js","packages/ostrio:user-status/client/throttle.js"],"names":["module","export","UserStatus","throttle","link","default","v","Meteor","Session","Tracker","Accounts","ReactiveVar","NoOp","UserStatusClass","constructor","setDefault","status","hidden","str","evt","document","mozHidden","msHidden","webkitHidden","check","set","goIdle","goOnline","autorun","_user","user","profile","idle","online","on","window","bind","obj","events","fn","forEach","event","addEventListener","passive","capture","attachEvent","_id","users","update","$set","goOffline","startTimer","setInterval","start","onLogin","onLogout","exportDefault","func","wait","options","context","args","result","timeout","previous","later","leading","Date","now","apply","remaining","arguments","clearTimeout","trailing","setTimeout"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAAA,MAAM,CAACC,MAAP,CAAc;AAACC,YAAU,EAAC,MAAIA;AAAhB,CAAd;AAA2C,IAAIC,QAAJ;AAAaH,MAAM,CAACI,IAAP,CAAY,YAAZ,EAAyB;AAACC,SAAO,CAACC,CAAD,EAAG;AAACH,YAAQ,GAACG,CAAT;AAAW;;AAAvB,CAAzB,EAAkD,CAAlD;AAAqD,IAAIC,MAAJ;AAAWP,MAAM,CAACI,IAAP,CAAY,eAAZ,EAA4B;AAACG,QAAM,CAACD,CAAD,EAAG;AAACC,UAAM,GAACD,CAAP;AAAS;;AAApB,CAA5B,EAAkD,CAAlD;AAAqD,IAAIE,OAAJ;AAAYR,MAAM,CAACI,IAAP,CAAY,gBAAZ,EAA6B;AAACI,SAAO,CAACF,CAAD,EAAG;AAACE,WAAO,GAACF,CAAR;AAAU;;AAAtB,CAA7B,EAAqD,CAArD;AAAwD,IAAIG,OAAJ;AAAYT,MAAM,CAACI,IAAP,CAAY,gBAAZ,EAA6B;AAACK,SAAO,CAACH,CAAD,EAAG;AAACG,WAAO,GAACH,CAAR;AAAU;;AAAtB,CAA7B,EAAqD,CAArD;AAAwD,IAAII,QAAJ;AAAaV,MAAM,CAACI,IAAP,CAAY,sBAAZ,EAAmC;AAACM,UAAQ,CAACJ,CAAD,EAAG;AAACI,YAAQ,GAACJ,CAAT;AAAW;;AAAxB,CAAnC,EAA6D,CAA7D;AAAgE,IAAIK,WAAJ;AAAgBX,MAAM,CAACI,IAAP,CAAY,qBAAZ,EAAkC;AAACO,aAAW,CAACL,CAAD,EAAG;AAACK,eAAW,GAACL,CAAZ;AAAc;;AAA9B,CAAlC,EAAkE,CAAlE;;AAOlZ,MAAMM,IAAI,GAAG,YAAW,CAAE,CAA1B;;AAEA,MAAMC,eAAN,CAAsB;AACpBC,aAAW,GAAG;AACZN,WAAO,CAACO,UAAR,CAAmB,gBAAnB,EAAqC,KAArC;AACA,SAAKC,MAAL,GAAc,IAAIL,WAAJ,CAAgB,SAAhB,CAAd;AACA,SAAKM,MAAL,GAAc,EAAd;AAEA;;AACA,SAAKA,MAAL,CAAYC,GAAZ,GAAkB,KAAlB;AACA,SAAKD,MAAL,CAAYE,GAAZ,GAAkB,KAAK,CAAvB;;AACA,QAAI,OAAOC,QAAQ,CAACH,MAAhB,KAA2B,WAA/B,EAA4C;AAC1C,WAAKA,MAAL,CAAYC,GAAZ,GAAkB,QAAlB;AACA,WAAKD,MAAL,CAAYE,GAAZ,GAAkB,kBAAlB;AACD,KAHD,MAGO,IAAI,OAAOC,QAAQ,CAACC,SAAhB,KAA8B,WAAlC,EAA+C;AACpD,WAAKJ,MAAL,CAAYC,GAAZ,GAAkB,WAAlB;AACA,WAAKD,MAAL,CAAYE,GAAZ,GAAkB,qBAAlB;AACD,KAHM,MAGA,IAAI,OAAOC,QAAQ,CAACE,QAAhB,KAA6B,WAAjC,EAA8C;AACnD,WAAKL,MAAL,CAAYC,GAAZ,GAAkB,UAAlB;AACA,WAAKD,MAAL,CAAYE,GAAZ,GAAkB,oBAAlB;AACD,KAHM,MAGA,IAAI,OAAOC,QAAQ,CAACG,YAAhB,KAAiC,WAArC,EAAkD;AACvD,WAAKN,MAAL,CAAYC,GAAZ,GAAkB,cAAlB;AACA,WAAKD,MAAL,CAAYE,GAAZ,GAAkB,wBAAlB;AACD;;AAED,SAAKF,MAAL,CAAYO,KAAZ,GAAoB,MAAM;AACxB,aAAOJ,QAAQ,CAAC,KAAKH,MAAL,CAAYC,GAAb,CAAf;AACD,KAFD;AAIA;;;AACA,SAAKD,MAAL,CAAYQ,GAAZ,GAAkB,MAAM;AACtB,UAAI,KAAKR,MAAL,CAAYO,KAAZ,EAAJ,EAAyB;AACvB,aAAKE,MAAL;AACD,OAFD,MAEO;AACL,aAAKC,QAAL;AACD;AACF,KAND;;AAQAlB,WAAO,CAACmB,OAAR,CAAgB,MAAM;AACpB,YAAMC,KAAK,GAAGtB,MAAM,CAACuB,IAAP,EAAd;;AACA,UAAID,KAAJ,EAAW;AACTrB,eAAO,CAACiB,GAAR,CAAY,gBAAZ,EAA8BI,KAAK,CAACE,OAAN,CAAcC,IAAd,IAAsB,KAApD;;AACA,YAAIH,KAAK,CAACE,OAAN,CAAcC,IAAlB,EAAwB;AACtB,eAAKhB,MAAL,CAAYS,GAAZ,CAAgB,MAAhB;AACD,SAFD,MAEO,IAAII,KAAK,CAACE,OAAN,CAAcE,MAAlB,EAA0B;AAC/B,eAAKjB,MAAL,CAAYS,GAAZ,CAAgB,QAAhB;AACD,SAFM,MAEA;AACL,eAAKT,MAAL,CAAYS,GAAZ,CAAgB,SAAhB;AACD;AACF,OATD,MASO;AACLjB,eAAO,CAACiB,GAAR,CAAY,gBAAZ,EAA8B,KAA9B;AACA,aAAKT,MAAL,CAAYS,GAAZ,CAAgB,SAAhB;AACD;AACF,KAfD;AAiBA;;AACA,SAAKS,EAAL,CAAQd,QAAR,EAAkB,CAAC,KAAKH,MAAL,CAAYE,GAAb,CAAlB,EAAqC,KAAKF,MAAL,CAAYQ,GAAjD;AACA,SAAKS,EAAL,CAAQC,MAAR,EAAgB,CAAC,WAAD,EAAc,WAAd,EAA2B,UAA3B,EAAuC,gBAAvC,EAAyD,YAAzD,EAAuE,WAAvE,EAAoF,eAApF,EAAqG,eAArG,CAAhB,EAAuIhC,QAAQ,CAAC,KAAKwB,QAAL,CAAcS,IAAd,CAAmB,IAAnB,CAAD,EAA2B,GAA3B,CAA/I;AACA,SAAKF,EAAL,CAAQd,QAAR,EAAkB,CAAC,WAAD,EAAc,WAAd,EAA2B,UAA3B,EAAuC,gBAAvC,EAAyD,YAAzD,EAAuE,WAAvE,EAAoF,eAApF,EAAqG,eAArG,CAAlB,EAAyIjB,QAAQ,CAAC,KAAKwB,QAAL,CAAcS,IAAd,CAAmB,IAAnB,CAAD,EAA2B,GAA3B,CAAjJ;AACD;;AAEDF,IAAE,CAACG,GAAD,EAAMC,MAAN,EAAcC,EAAd,EAAkB;AAClBD,UAAM,CAACE,OAAP,CAAgBC,KAAD,IAAW;AACxB,UAAIJ,GAAG,CAACK,gBAAR,EAA0B;AACxBL,WAAG,CAACK,gBAAJ,CAAqBD,KAArB,EAA4BF,EAA5B,EAAgC;AAAEI,iBAAO,EAAE,IAAX;AAAiBC,iBAAO,EAAE;AAA1B,SAAhC;AACD,OAFD,MAEO;AACLP,WAAG,CAACQ,WAAJ,CAAgB,OAAOJ,KAAvB,EAA8BF,EAA9B;AACD;AACF,KAND;AAOD;;AAEDZ,UAAQ,GAAG;AACT,UAAME,KAAK,GAAGtB,MAAM,CAACuB,IAAP,EAAd;;AACA,QAAID,KAAK,IAAIA,KAAK,CAACiB,GAAf,KAAuBjB,KAAK,CAACE,OAAN,CAAcE,MAAd,KAAyB,IAAzB,IAAiCJ,KAAK,CAACE,OAAN,CAAcC,IAAd,KAAuB,KAA/E,CAAJ,EAA2F;AACzFzB,YAAM,CAACwC,KAAP,CAAaC,MAAb,CAAoB;AAClBF,WAAG,EAAEjB,KAAK,CAACiB;AADO,OAApB,EAEG;AACDG,YAAI,EAAE;AACJ,4BAAkB,IADd;AAEJ,0BAAgB;AAFZ;AADL,OAFH,EAOGrC,IAPH;AAQD;AACF;;AAEDc,QAAM,GAAG;AACP,UAAMG,KAAK,GAAGtB,MAAM,CAACuB,IAAP,EAAd;;AACA,QAAID,KAAK,IAAIA,KAAK,CAACiB,GAAf,KAAuBjB,KAAK,CAACE,OAAN,CAAcE,MAAd,KAAyB,IAAzB,IAAiCJ,KAAK,CAACE,OAAN,CAAcC,IAAd,KAAuB,IAA/E,CAAJ,EAA0F;AACxFzB,YAAM,CAACwC,KAAP,CAAaC,MAAb,CAAoB;AAClBF,WAAG,EAAEjB,KAAK,CAACiB;AADO,OAApB,EAEG;AACDG,YAAI,EAAE;AACJ,4BAAkB,IADd;AAEJ,0BAAgB;AAFZ;AADL,OAFH,EAOGrC,IAPH;AAQD;AACF;;AAEDsC,WAAS,GAAwB;AAAA,QAAvBrB,KAAuB,uEAAftB,MAAM,CAACuB,IAAP,EAAe;;AAC/B,QAAID,KAAK,IAAIA,KAAK,CAACiB,GAAf,KAAuBjB,KAAK,CAACE,OAAN,CAAcE,MAAd,KAAyB,KAAzB,IAAkCJ,KAAK,CAACE,OAAN,CAAcC,IAAd,KAAuB,KAAhF,CAAJ,EAA4F;AAC1FzB,YAAM,CAACwC,KAAP,CAAaC,MAAb,CAAoB;AAClBF,WAAG,EAAEjB,KAAK,CAACiB;AADO,OAApB,EAEG;AACDG,YAAI,EAAE;AACJ,4BAAkB,KADd;AAEJ,0BAAgB;AAFZ;AADL,OAFH,EAOGrC,IAPH;AAQD;AACF;;AAEDuC,YAAU,GAAG;AACX5C,UAAM,CAAC6C,WAAP,CAAmB,KAAK1B,MAAL,CAAYU,IAAZ,CAAiB,IAAjB,CAAnB,EAA2C,KAA3C;AACD;;AAEDiB,OAAK,GAAG;AACN,SAAKF,UAAL;AACD;;AApHmB;;AAuHtB,MAAMjD,UAAU,GAAG,IAAIW,eAAJ,EAAnB;AACAH,QAAQ,CAAC4C,OAAT,CAAiBpD,UAAU,CAACmD,KAAX,CAAiBjB,IAAjB,CAAsBlC,UAAtB,CAAjB;AACAQ,QAAQ,CAAC6C,QAAT,CAAkBrD,UAAU,CAACgD,SAAX,CAAqBd,IAArB,CAA0BlC,UAA1B,CAAlB,E;;;;;;;;;;;AClIAF,MAAM,CAACwD,aAAP,CAAe,UAAUC,IAAV,EAAgBC,IAAhB,EAAoC;AAAA,MAAdC,OAAc,uEAAJ,EAAI;AACjD,MAAIC,OAAJ;AACA,MAAIC,IAAJ;AACA,MAAIC,MAAJ;AACA,MAAIC,OAAO,GAAG,IAAd;AACA,MAAIC,QAAQ,GAAG,CAAf;;AAEA,QAAMC,KAAK,GAAG,MAAM;AAClBD,YAAQ,GAAGL,OAAO,CAACO,OAAR,KAAoB,KAApB,GAA4B,CAA5B,GAAgCC,IAAI,CAACC,GAAL,EAA3C;AACAL,WAAO,GAAG,IAAV;AACAD,UAAM,GAAGL,IAAI,CAACY,KAAL,CAAWT,OAAX,EAAoBC,IAApB,CAAT;;AACA,QAAI,CAACE,OAAL,EAAc;AACZH,aAAO,GAAGC,IAAI,GAAG,IAAjB;AACD;AACF,GAPD;;AASA,SAAO,YAAW;AAChB,UAAMO,GAAG,GAAGD,IAAI,CAACC,GAAL,EAAZ;;AACA,QAAI,CAACJ,QAAD,IAAaL,OAAO,CAACO,OAAR,KAAoB,KAArC,EAA4C;AAC1CF,cAAQ,GAAGI,GAAX;AACD;;AAED,UAAME,SAAS,GAAGZ,IAAI,IAAIU,GAAG,GAAGJ,QAAV,CAAtB;AACAJ,WAAO,GAAG,IAAV;AACAC,QAAI,GAAGU,SAAP;;AACA,QAAID,SAAS,IAAI,CAAb,IAAkBA,SAAS,GAAGZ,IAAlC,EAAwC;AACtC,UAAIK,OAAJ,EAAa;AACXS,oBAAY,CAACT,OAAD,CAAZ;AACAA,eAAO,GAAG,IAAV;AACD;;AAEDC,cAAQ,GAAGI,GAAX;AACAN,YAAM,GAAGL,IAAI,CAACY,KAAL,CAAWT,OAAX,EAAoBC,IAApB,CAAT;;AAEA,UAAI,CAACE,OAAL,EAAc;AACZH,eAAO,GAAGC,IAAI,GAAG,IAAjB;AACD;AACF,KAZD,MAYO,IAAI,CAACE,OAAD,IAAYJ,OAAO,CAACc,QAAR,KAAqB,KAArC,EAA4C;AACjDV,aAAO,GAAGW,UAAU,CAACT,KAAD,EAAQK,SAAR,CAApB;AACD;;AACD,WAAOR,MAAP;AACD,GAzBD;AA0BD,CA1CD,E","file":"/packages/ostrio_user-status.js","sourcesContent":["import throttle        from './throttle';\nimport { Meteor }      from 'meteor/meteor';\nimport { Session }     from 'meteor/session';\nimport { Tracker }     from 'meteor/tracker';\nimport { Accounts }    from 'meteor/accounts-base';\nimport { ReactiveVar } from 'meteor/reactive-var';\n\nconst NoOp = function() {};\n\nclass UserStatusClass {\n  constructor() {\n    Session.setDefault('UserStatusIdle', false);\n    this.status = new ReactiveVar('offline');\n    this.hidden = {};\n\n    /* @description Set right visibilitychange event and property names */\n    this.hidden.str = false;\n    this.hidden.evt = void 0;\n    if (typeof document.hidden !== 'undefined') {\n      this.hidden.str = 'hidden';\n      this.hidden.evt = 'visibilitychange';\n    } else if (typeof document.mozHidden !== 'undefined') {\n      this.hidden.str = 'mozHidden';\n      this.hidden.evt = 'mozvisibilitychange';\n    } else if (typeof document.msHidden !== 'undefined') {\n      this.hidden.str = 'msHidden';\n      this.hidden.evt = 'msvisibilitychange';\n    } else if (typeof document.webkitHidden !== 'undefined') {\n      this.hidden.str = 'webkitHidden';\n      this.hidden.evt = 'webkitvisibilitychange';\n    }\n\n    this.hidden.check = () => {\n      return document[this.hidden.str];\n    };\n\n    /* @description Set active/inactive user status */\n    this.hidden.set = () => {\n      if (this.hidden.check()) {\n        this.goIdle();\n      } else {\n        this.goOnline();\n      }\n    };\n\n    Tracker.autorun(() => {\n      const _user = Meteor.user();\n      if (_user) {\n        Session.set('UserStatusIdle', _user.profile.idle || false);\n        if (_user.profile.idle) {\n          this.status.set('idle');\n        } else if (_user.profile.online) {\n          this.status.set('online');\n        } else {\n          this.status.set('offline');\n        }\n      } else {\n        Session.set('UserStatusIdle', false);\n        this.status.set('offline');\n      }\n    });\n\n    /* @description Set event listeners */\n    this.on(document, [this.hidden.evt], this.hidden.set);\n    this.on(window, ['mousemove', 'mousedown', 'keypress', 'DOMMouseScroll', 'mousewheel', 'touchmove', 'MSPointerMove', 'MSPointerMove'], throttle(this.goOnline.bind(this), 777));\n    this.on(document, ['mousemove', 'mousedown', 'keypress', 'DOMMouseScroll', 'mousewheel', 'touchmove', 'MSPointerMove', 'MSPointerMove'], throttle(this.goOnline.bind(this), 777));\n  }\n\n  on(obj, events, fn) {\n    events.forEach((event) => {\n      if (obj.addEventListener) {\n        obj.addEventListener(event, fn, { passive: true, capture: false });\n      } else {\n        obj.attachEvent('on' + event, fn);\n      }\n    });\n  }\n\n  goOnline() {\n    const _user = Meteor.user();\n    if (_user && _user._id && (_user.profile.online !== true || _user.profile.idle !== false)) {\n      Meteor.users.update({\n        _id: _user._id\n      }, {\n        $set: {\n          'profile.online': true,\n          'profile.idle': false\n        }\n      }, NoOp);\n    }\n  }\n\n  goIdle() {\n    const _user = Meteor.user();\n    if (_user && _user._id && (_user.profile.online !== true || _user.profile.idle !== true)) {\n      Meteor.users.update({\n        _id: _user._id\n      }, {\n        $set: {\n          'profile.online': true,\n          'profile.idle': true\n        }\n      }, NoOp);\n    }\n  }\n\n  goOffline(_user = Meteor.user()) {\n    if (_user && _user._id && (_user.profile.online !== false || _user.profile.idle !== false)) {\n      Meteor.users.update({\n        _id: _user._id\n      }, {\n        $set: {\n          'profile.online': false,\n          'profile.idle': false\n        }\n      }, NoOp);\n    }\n  }\n\n  startTimer() {\n    Meteor.setInterval(this.goIdle.bind(this), 30000);\n  }\n\n  start() {\n    this.startTimer();\n  }\n}\n\nconst UserStatus = new UserStatusClass();\nAccounts.onLogin(UserStatus.start.bind(UserStatus));\nAccounts.onLogout(UserStatus.goOffline.bind(UserStatus));\n\nexport { UserStatus };\n","export default function (func, wait, options = {}) {\n  let context;\n  let args;\n  let result;\n  let timeout = null;\n  let previous = 0;\n\n  const later = () => {\n    previous = options.leading === false ? 0 : Date.now();\n    timeout = null;\n    result = func.apply(context, args);\n    if (!timeout) {\n      context = args = null;\n    }\n  };\n\n  return function() {\n    const now = Date.now();\n    if (!previous && options.leading === false) {\n      previous = now;\n    }\n\n    const remaining = wait - (now - previous);\n    context = this;\n    args = arguments;\n    if (remaining <= 0 || remaining > wait) {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n\n      previous = now;\n      result = func.apply(context, args);\n\n      if (!timeout) {\n        context = args = null;\n      }\n    } else if (!timeout && options.trailing !== false) {\n      timeout = setTimeout(later, remaining);\n    }\n    return result;\n  };\n}\n"]}}]